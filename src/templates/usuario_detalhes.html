{% extends 'base.html' %}

{% block head %}
<title>Detalhes do Usuário</title>
{% endblock %}

{% block body %}
<section class="bg-light py-3 py-md-5 mt-2">
    <div class="col md-10 container">
        <h3>Detalhes do Usuário</h3>
        <table class="table table-striped" style="width:100%">
            <thead>
            <tr>
                <th>Nome</th>
                <th>CPF</th>
                <th>E-mail</th>
                <th>Função</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>{{ usuario.nome }}</td>
                <td>{{ usuario.cpf }}</td>
                <td>{{ usuario.email }}</td>
                <td>{{ usuario.funcao_ocupacao }}</td>
            </tr>
            </tbody>
        </table>

        <!-- Botão para exibir o formulário de edição -->
        <button class="btn btn-warning" id="btn-editar">Editar Usuário</button>
        <button style="text-decoration: none" href="#" class="btn btn-danger" id='btn-excluir' data-bs-toggle="modal"
                data-bs-target="#excluirPost">Excluir Usuário
        </button>

        <!-- Formulário de edição do usuário (inicialmente oculto) -->
        <div id="form-editar" style="display:none;">
            <form method="POST" action="">
                {{ form.hidden_tag() }}
                <div class="row gy-2 overflow-hidden">
                    <div class="col-12">
                        <div class="form-floating mb-3">
                            <div class="form-group">
                                {{ form.nome.label(class="form-control-label") }}
                                {% if form.nome.errors %}
                                {{ form.nome(class="form-control is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for erro in form.nome.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.nome(class="form-control", readonly=True) }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-floating mb-3">
                            <div class="form-group">
                                {{ form.email.label(class="form-control-label") }}
                                {% if form.email.errors %}
                                {{ form.email(class="form-control is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for erro in form.email.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.email(class="form-control") }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-floating mb-3">
                            <div class="form-group">
                                {{ form.cpf.label(class="form-control-label") }}
                                {% if form.cpf.errors %}
                                {{ form.cpf(class="form-control is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for erro in form.cpf.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.cpf(class="form-control", readonly=True) }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-floating mb-3">
                            <div class="form-group">
                                {{ form.funcao_user_id.label(class="form-control-label") }}
                                {% if form.funcao_user_id.errors %}
                                {{ form.funcao_user_id(class="form-control is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for erro in form.funcao_user_id.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.funcao_user_id(class="form-control") }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-floating mb-3">
                            <div class="form-group">
                                {{ form.senha.label(class="form-control-label") }}
                                {% if form.senha.errors %}
                                {{ form.senha(class="form-control is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for erro in form.senha.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.senha(class="form-control") }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-floating mb-3">
                            <div class="form-group">
                                {{ form.confirmar_senha.label(class="form-control-label") }}
                                {% if form.confirmar_senha.errors %}
                                {{ form.confirmar_senha(class="form-control is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for erro in form.confirmar_senha.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.confirmar_senha(class="form-control") }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-grid my-3">
                            {{ form.botao_submit_criar_conta(class="btn btn-outline-primary mt-2") }}
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- Modal -->
<div class="modal fade" id="excluirPost" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Excluir Usuário?</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Essa ação não poderá ser desfeita e o usuário será excluído permanentemente do sistema.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <form method="POST" action="{{ url_for('excluir_usuario', usuario_id=usuario.id) }}">
                    <button type="submit" class="botaoExcluir">Excluir</button>
                </form>
            </div>
        </div>
    </div>
</div>
<script src="{{ url_for('static', filename='js/usuario_detalhes_down.js') }}"></script>
{% endblock %}
